<div class="container mx-auto p-6">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold">Inventory</h2>
        <button mat-raised-button color="primary" (click)="navigateToAdd()">
            <mat-icon>add</mat-icon> Add Inventory
        </button>
    </div>

    <div class="mat-elevation-z8 overflow-auto">
        <div class="loading-state p-4" *ngIf="isLoading">
            Loading inventory...
        </div>

        <div class="error-state p-4 text-red-500" *ngIf="errorMessage">
            {{ errorMessage }}
        </div>

        <table mat-table [dataSource]="dataSource" matSort *ngIf="!isLoading && !errorMessage" class="w-full">

            <!-- Variant Column -->
            <ng-container matColumnDef="variant">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Variant </th>
                <td mat-cell *matCellDef="let row">
                    {{ row.ProductVariant?.variant_code }}
                    <span class="text-xs text-gray-500 block">{{ row.ProductVariant?.Product?.product_name }}</span>
                </td>
            </ng-container>

            <!-- Warehouse Column -->
            <ng-container matColumnDef="warehouse">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Warehouse </th>
                <td mat-cell *matCellDef="let row"> {{ row.Warehouse?.warehouse_name }} </td>
            </ng-container>

            <!-- Qty On Hand Column -->
            <ng-container matColumnDef="qty_on_hand">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Qty On Hand </th>
                <td mat-cell *matCellDef="let row"> {{ row.qty_on_hand }} </td>
            </ng-container>

            <!-- Qty Reserved Column -->
            <ng-container matColumnDef="qty_reserved">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Qty Reserved </th>
                <td mat-cell *matCellDef="let row"> {{ row.qty_reserved }} </td>
            </ng-container>

            <!-- Cost Column -->
            <ng-container matColumnDef="cost_per_unit">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Cost </th>
                <td mat-cell *matCellDef="let row"> {{ row.cost_per_unit | currency:'INR' }} </td>
            </ng-container>

            <!-- Mfg Date Column -->
            <ng-container matColumnDef="mfg_date">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Mfg Date </th>
                <td mat-cell *matCellDef="let row"> {{ row.mfg_date | date }} </td>
            </ng-container>

            <!-- Expiry Date Column -->
            <ng-container matColumnDef="expiry_date">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Expiry Date </th>
                <td mat-cell *matCellDef="let row"> {{ row.expiry_date | date }} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            <!-- Row shown when there is no matching data. -->
            <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell p-4 text-center" colspan="7">No inventory records found</td>
            </tr>
        </table>

        <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of inventory"></mat-paginator>
    </div>
</div>